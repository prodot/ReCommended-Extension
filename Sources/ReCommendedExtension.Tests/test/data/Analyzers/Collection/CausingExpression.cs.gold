using System.Collections.Generic;

namespace Test
{
    public class C(int i)
    {
        void Detection(bool f, C[] array)
        {
            var v1 = f ? ||new C[]|(0)|(1) { new(1), new(2) } : array;

            var v2 = array ?? ||new C[]|(2)|(3) { new(1), new(2) };

            var v3 = f switch
            {
                true => ||new C[]|(4)|(5) { new(1), new(2) },
                _ => array,
            };
        }

        void NoDetection(bool f)
        {
            var v1 = f ? new C[] { new(1), new(2) } : [new(1), new(2)];

            var v3 = f switch
            {
                true => new C[] { new(1), new(2) },
                _ => [new(1), new(2)],
            };

            var v4 = new C[] { new(1), new(2) };
        }
    }
}
---------------------------------------------------------
(0): ReSharper Suggestion: Use collection expression
(1): ReSharper Suggestion: Use collection expression ('C[]' will be used).
(2): ReSharper Suggestion: Use collection expression
(3): ReSharper Suggestion: Use collection expression ('C[]' will be used).
(4): ReSharper Suggestion: Use collection expression
(5): ReSharper Suggestion: Use collection expression ('C[]' will be used).
